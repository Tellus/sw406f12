\section{Language semantics}
\begin{comment}
The language is a language used for  of a role-playing characters. I addiction to the language is an battle engine, which simulates a battle between the  character. \\
The engine works, so that lets one character make an action, then the turn end, and the other character then gets to make its action. \\
The action a character makes, is calculated by an AI-behaviour. The AI-behaviour is base at a behaviour declared for the character. \\
Before a character gets to make its turn, win condition is checked, so that the character does not get to make an action if its health is below zero.  

\subsection{Environment-store model}
The semantics of the language is base at the environment-store model, which is a a model describing how variables are bound during a program execution. Each variable is bound to a storage cell, and the content of the storage cell is the value of the variable.

\subsection{\langname{} semantics}
\end{comment}

	%{\Large[The real stuff]}
The semantics of \langname{} are based on the environment-store model, described in section \ref{sec:semantic}.
The semantics are split into two parts; declarations in \langname{}, and the inner workings of the engine used to simulate a battle between two characters.\\
In \langname{} it is possible for the user to use references, they are called \ac{rgrs}. In the semantics of \langname{}, \ac{rgr} is a set of keywords used to refer to characters.\\ \textbf{RGR} is defined as follows;  
%
$$\mathbf{RGR} = \{\texttt{owner, enemy}\}$$
%
\ac{rgrs} are used in the declaration of abilities and behaviour. An ability is declared by a name and contains; the targets to be effected by the ability, an effect corresponding carried out by the ability and two values. The first value representing the mana cost of the ability and the second representing the damage done.\\
To keep track of the bindings of an ability, an \textit{ability environment} is used. The set of ability environments is called \textbf{Ability}. 
Given an ability name \textit{AName}, an ability environment must hold information about, targets, effect, cost, and damage. Therefore the definition of the set of ability environments \textbf{Ability} is:
%
$$\mathbf{Ability: \; AName \rightharpoonup \mathcal{P}(RGR) \times Effect \times Integer \times Integer}$$
%
As mentioned, \ac{rgrs} are used for behaviour as well. A behaviour is declared by a name and it contains a list of 3-tuples (\textbf{\ac{rgr}}, \textbf{VName}, \textbf{Integer}), where \textbf{\ac{rgr}} is a reference to the involved character, \textbf{VName} is the name of the involved attribute and \textbf{Integer} is a value representing the priority of the attribute. To keep track of the bindings of a behaviour, a \textit{behaviour environment} is used. The set of behaviour environments is called \textbf{Behaviour}.
A behaviour environment must, given a behaviour name \textit{BName}, hold information of the list of 3-tuples. Therefore the definition of the set of behaviour environments is:
%
$$\mathbf{Behaviour: \; BName \rightharpoonup \mathcal{P}(RGR \times VName \times Integer)}$$
%
%Event
For declaring forced action for a character, \langname{} makes it possible for a user to declare event, which contains a trigger(decrease of health), a condition(health below 10\%) and an ability to execute when both the trigger and the condition is meet.
A \textit{event environment} is used to keep track of the binding for events. The set of event environments is called \textbf{Event}.
Given an event name, the event environment must hold information about the trigger, condition and ability. Therefore the definition of the set of event environments is:
%
$$\mathbf{Event : \; EName \rightharpoonup Trigger \times Condition \times AName}$$
%
%Resource

When a character is declared, they are declared with some resources like health and mana. The resources have a maximum and minimum value. A resource therefore has bindings for the two values. To keep track of these bindings a \textit{resource environment} is used.\\
The set of resource environments is called \textbf{Resource}, and is defined as follows:
%
$$\mathbf{Resource : \; RName \rightharpoonup Integer \times Integer}$$
%
It is also required to keep track of the bindings of the character itself. To keep track of the bindings a \textit{character environment} is used. The set of character environments is called \textbf{Character}.
Given a character name \textit{CName}, a character environment must hold information about the behaviour, abilities, attributes, events and resources bound to the character. Therefore the definition of the set of character environments \textbf{Character} is:
%
$$\mathbf{Character} : \; \mathbf{CName} \rightharpoonup \mathbf{Behaviour} \times \mathbf{\mathcal{P}(AName)} \times \mathbf{EnvV} \times \mathbf{EName} \times \mathbf{Resource}$$
%
\begin{comment}
Character is decelerated from its name, and contains, behaviour, a list of abilities,, an environment which contain variables decelerated for the character, event, and its resources.  

Ability is decelerated from it name, and it contains, a \ac{rgr}, an effect and an integer which represent the cost of the ability, and an 			other integer which represent the damage(or heal) the ability does.

\ac{rgr} is the set of keyword, used for references.


\end{comment}

\begin{table}
\begin{tabular}{l l}
\\ \hline \\
\small{\textsc{[Char-Dec]}} \\
 & \large{${\frac{\langle env, Health, Mana, sto, etc \rangle \; \Rightarrow \; env'}{\langle \texttt{make }  CName \texttt{ from } Character, \;
Name, A_D, R_D, Ability, Behaviour, Events\rangle}}$}\\
 & \footnotesize{$\Rightarrow env \; \vdash \; \langle sto, Attribute, HP, Integer \rangle$} \\
 \footnotesize{Where} $env'=$ &  \footnotesize{$env[Health \mapsto l] [\texttt{next} \mapsto \texttt{new } l, sto \mapsto std]$} \\
 & \footnotesize{$env[Mana \mapsto \texttt{new } l][\texttt{next } \mapsto \texttt{new new } l, sto \mapsto std]$} \\
 & \footnotesize{etc.} \\
 \\ \hline
\end{tabular}
\label{tbl:devC}
\caption{Transition rules for Character declaration, (\textsl{Remember to explain the ect.'s})}
\end{table}	

\begin{table}
\begin{tabular}{l l}
 \\ \hline \\
 \small{\textsc{[Event-Dec]}} & \\
 & \footnotesize{$\langle Char ,Ability, Behaviour, Event; \; Event EName, Trigger, Condition, AName \rangle ; \; S \Rightarrow$} \\
 & \footnotesize{$\langle Char, Ability, Behaviour, Event; Event[EName \mapsto (Trigger, Condition, AName)]; S \rangle$} \\
 \\ \hline
\end{tabular}
\label{tbl:devE}
\caption{Transition rules for Event declaration}
\end{table}

\begin{table}
\begin{tabular}{l l}
\\ \hline \\
\small{\textsc{[Ability-Dec]}}& \\
 & \footnotesize{$\langle Char, Ability, Behaviour, Event; \; Ability AName RGR, Effect, Int, Int \rangle \; \Rightarrow$} \\
 & \footnotesize{$\langle Char, Ability[AName \mapsto (RGR, Effect, Int, Int)], Behaviour, Event; S \rangle$} \\
\\ \hline
\end{tabular}
\label{tbl:decA}
\caption{Transition rules for Ability declaration}
\end{table}

\begin{table}
\begin{tabular}{l l l}
\\ \hline \\
\small{\textsc{[Behaviour-Dec]}} & \\
 & \footnotesize{$\langle Char, Ability, Behaviour, Event; Behaviour BName,$} & \footnotesize{$RGR_1, VName_1, Integer_1$} \\
 & & \footnotesize{$RGR_2, VName_2, Integer_2$}\\
 & & \footnotesize{$RGR_3, VName_3, Integer_3$} \\
 & & \footnotesize{$\vdots$} \\
 & & \footnotesize{$RGR_n, VName_n, Integer_n  \rangle ; S \; \Rightarrow$} \\
\end{tabular}
\begin{tabular}{l p{0.92\textwidth}}
 & \footnotesize{$\langle Char, Ability, Behaviour', Event \rangle; S$} \\ %& \color{white} \footnotesize{$RGR_1, VName_1, Integer_1 \Rightarrow$} \\
\footnotesize{Where $Behaviour' = $} & \footnotesize{$Behaviour[BName \mapsto {\bigcup^{n}_{i = 0}} (RGR_i, VName_i, Integer_i)]$} \\
\\  \hline 
\end{tabular}
\label{tbl:decB}
\caption{Transition rules for Behaviour declaration}
\end{table}

\begin{table}
\begin{tabular}{l l}
\\ \hline \\
\small{\textsc{[Turn]}} & \\
 & \footnotesize{$Char, Behaviour, Ability, Event, Resource \vdash \langle Active, Next, sto \rangle \Rightarrow \langle Next, Active, sto \rangle$} \\
 \\
\footnotesize{Where} & \footnotesize{$Char(Active) = (Behaviour, \mathcal{P}(AName), env, Ename, Resource)$} \\
\footnotesize{And} & \footnotesize{$Env(Health) > 0$} \\
 & \footnotesize{$\forall e \in Events. Event(e) \rightarrow_b f \! \! f$} \\
 & \footnotesize{$Be = Behaviour(Beh)$} \\
\\ \hline
\end{tabular}
\label{tbl:Turn}
\caption{Transition rules for Turn.}
\end{table}

\begin{table}
\begin{tabular}{l l}
\\ \hline \\
\small{\textsc{[Ability-Exe]}} & \\
& \footnotesize{$Char_{Active}, Char_{Next}, Ability \vdash \langle AName, sto \rangle \Rightarrow \langle sto[Char_{Active}(Mana) \; -\!\! = cost] \rangle$} \\
\footnotesize{Where} & \footnotesize{$ef\!f = (enemy, ef\!f, cost, ef\!fMana)$}\\
 & \footnotesize{$ef\!fect(sto, Char_{Next}, ef\!fMana) = sto'$}\\
\\ \hline
\end{tabular}
\label{tbl:abi-exe}
\caption{Transition rules for execution of an ability}
\end{table}


\begin{table}
\begin{tabular}{l l}
\\ \hline \\
\small{\textsc{Physical-Dmg}} & \\
 & \footnotesize{$Physical \langle sto, l \rangle \Rightarrow sto[l \mapsto x - i]$} \\
 \\ \hline
\end{tabular}
\label{tbl:physical}
\caption{Transition rule for Physical damage}
\end{table}

%%%%%%%%%%%%%
% Vi har nogle regler der skal beskrives med brødtekst.
% Kan ikke lige huske hvilke der mangler lige nu.. Det håber jeg at Danny kan hjælpe med at huske........
%%%%%%%%%%%%%
$$\frac{\textbf{uden d}}{\textbf{uden d}}$$

$$\dfrac{\textbf{med d}}{\textbf{med d}}$$